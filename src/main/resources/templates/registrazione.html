<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ResolveIT - Registrazione</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/auth.css}">
</head>
<body>

<div th:replace="~{fragments/header :: header-fragment}"></div>

<main class="auth-main">
    <div class="hero-section">
        <h1>Il tuo helpdesk,<br> sempre sotto<br> controllo</h1>
        <img th:src="@{/images/landingImage.png}" alt="Landing" class="hero-image">
    </div>

    <div class="form-section">
        <div class="auth-card">
            <h2>Crea un account</h2>

            <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
            <div th:if="${errorMessage}" class="alert alert-error" th:text="${errorMessage}"></div>

            <form method="post" th:action="@{/register}" th:object="${utenteDTO}" novalidate>

                <div class="form-row">
                    <div class="form-group">
                        <label>Nome</label>
                        <input type="text" maxlength="30" th:field="*{nome}"
                               placeholder="Mario"
                               th:classappend="${#fields.hasErrors('nome')} ? 'is-invalid' : ''">

                        <div class="invalid-feedback" th:if="${#fields.hasErrors('nome')}">
                            <span th:with="errs=${#fields.detailedErrors('nome')}"
                                  th:text="${errs.?[code == 'NotBlank'].size() > 0 ? errs.?[code == 'NotBlank'][0].message : errs[0].message}">
                            </span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Cognome</label>
                        <input type="text" maxlength="30" th:field="*{cognome}"
                               placeholder="Rossi"
                               th:classappend="${#fields.hasErrors('cognome')} ? 'is-invalid' : ''">

                        <div class="invalid-feedback" th:if="${#fields.hasErrors('cognome')}">
                            <span th:with="errs=${#fields.detailedErrors('cognome')}"
                                  th:text="${errs.?[code == 'NotBlank'].size() > 0 ? errs.?[code == 'NotBlank'][0].message : errs[0].message}">
                            </span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Indirizzo Email</label>
                    <input type="email" maxlength="100" th:field="*{email}"
                           placeholder="nome@esempio.com"
                           th:classappend="${#fields.hasErrors('email')} ? 'is-invalid' : ''">

                    <div class="invalid-feedback" th:if="${#fields.hasErrors('email')}">
                        <span th:with="errs=${#fields.detailedErrors('email')}"
                              th:text="${errs.?[code == 'NotBlank'].size() > 0 ? errs.?[code == 'NotBlank'][0].message : errs[0].message}">
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Password</label>
                    <div class="password-wrapper">
                        <input type="password" maxlength="64" th:field="*{password}"
                               placeholder="Almeno 8 caratteri"
                               th:classappend="${#fields.hasErrors('password')} ? 'is-invalid' : ''">
                        <i class="fa-solid fa-eye eye-icon"></i>
                    </div>
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('password')}">
                        <span th:with="errs=${#fields.detailedErrors('password')}"
                              th:text="${errs.?[code == 'NotBlank'].size() > 0 ? errs.?[code == 'NotBlank'][0].message : errs[0].message}">
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Conferma Password</label>
                    <div class="password-wrapper">
                        <input type="password" maxlength="64" th:field="*{confermaPassword}"
                               placeholder="Ripeti la password"
                               th:classappend="${#fields.hasErrors('confermaPassword')} ? 'is-invalid' : ''">
                        <i class="fa-solid fa-eye eye-icon"></i>
                    </div>
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('confermaPassword')}" th:errors="*{confermaPassword}"></div>
                </div>

                <button type="submit" class="btn-auth">Registrati</button>
            </form>

            <div class="auth-footer">
                <p>Hai gi√† un account? <a th:href="@{/login}">Accedi qui</a></p>
            </div>
        </div>
    </div>
</main>

<div th:replace="~{fragments/footer :: footer-fragment}"></div>
<script th:src="@{/js/password-toggle.js}"></script>

</body>
</html>